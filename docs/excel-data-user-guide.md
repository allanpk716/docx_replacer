# Excel 数据支持用户指南

## 概述

DocuFiller 现在支持使用 Excel (.xlsx) 文件作为数据源，可以保留上标、下标等格式信息。

## Excel 文件格式

### 基本结构

Excel 文件应包含两列：
- **A 列（关键词）**: 符合 `#关键词#` 格式的标识符
- **B 列（值）**: 对应的值，支持富文本格式

示例：

| A 列         | B 列              |
|--------------|-------------------|
| #产品名称#    | D-二聚体          |
| #规格#        | 2x10⁹             |

### 创建格式化内容

1. 在 Excel 中输入值
2. 选中要格式化的部分（如 "9"）
3. 右键 → 设置单元格格式 → 字体 → 上标/下标

## 使用流程

### 1. 准备 Excel 数据文件

按照上述格式创建 Excel 文件，输入关键词和对应的值。

### 2. 选择 Word 模板

在 DocuFiller 中选择包含内容控件的 Word 模板。

### 3. 选择 Excel 数据文件

点击"浏览"按钮，选择准备好的 Excel 文件。

### 4. 预览数据

系统会自动验证并显示数据预览。如有错误，会显示详细信息。

### 5. 开始处理

点击"开始处理"按钮，生成带格式的 Word 文档。

## JSON 转 Excel

如果您有旧的 JSON 数据文件，可以使用内置的转换工具：

1. 点击主窗口的"JSON转Excel转换工具"链接
2. 选择要转换的 JSON 文件
3. 选择输出目录
4. 点击"开始转换"

转换后，您可以在 Excel 中添加需要的格式。

## 验证规则

系统会严格验证 Excel 文件：

- ✅ 文件扩展名必须是 `.xlsx`
- ✅ 关键词必须以 `#` 开头和结尾
- ✅ 关键词不能重复
- ⚠️ 值列为空会产生警告

## 常见问题

### Q: 转换后的文档没有显示格式？

A: 确保在 Excel 中正确设置了格式（上标/下标），然后在 Word 中检查内容控件的样式设置。

### Q: 可以同时使用 JSON 和 Excel 吗？

A: 可以，程序同时支持两种格式。但建议逐步迁移到 Excel 以获得更好的格式支持。

### Q: 转换工具可以批量处理吗？

A: 是的，转换工具支持多选文件批量转换。
