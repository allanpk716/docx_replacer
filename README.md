# docx_replacer 高级版本

专门解决Word文档表格中关键词被XML标签分割的问题。

## 功能特点

- **高级替换算法**：能够识别和替换被XML标签分割的关键词
- **表格支持**：专门优化了表格中的关键词替换
- **批量处理**：支持批量处理多个Word文档
- **单文件测试**：支持单个文件的测试和调试

## 使用方法

### 1. 准备配置文件

创建 `config.json` 文件，格式如下：

```json
{
  "keywords": [
    {
      "key": "#结构及组成#",
      "value": "主要由以下几个部分构成：核心组件、支撑结构、连接件等"
    },
    {
      "key": "#功能特点#",
      "value": "具有高效、稳定、可靠的特点"
    }
  ]
}
```

**注意**：关键词需要包含 `#` 号，如 `#结构及组成#`

### 2. 运行程序

```bash
go run .
```

### 3. 选择模式

- **模式1：高级批量替换模式** - 批量处理文件夹中的所有Word文档
- **模式2：高级单文件测试模式** - 处理单个Word文档，适合测试和调试

### 4. 按提示操作

程序会提示您拖拽相应的文件或文件夹：
- 配置文件 (config.json)
- 输入文件/文件夹
- 输出文件夹（批量模式）

## 核心优势

相比普通的文本替换，本工具能够：

1. **处理分割关键词**：当关键词在Word表格中被XML标签分割时，仍能正确识别和替换
2. **保持格式**：替换后保持原有的文档格式和样式
3. **高效处理**：专门优化的算法，处理速度快
4. **详细日志**：提供详细的处理日志和统计信息

## 文件结构

- `main.go` - 主程序入口
- `main_advanced.go` - 高级替换模式实现
- `advanced_replacer.go` - 核心高级替换算法
- `advanced_batch_processor.go` - 批量处理器
- `config.go` - 配置文件处理
- `utils.go` - 工具函数

## 示例

使用提供的 `test_config.json` 配置文件可以快速测试功能。